name: "Dev Container"

on:
  push:
    paths:
      - '.devcontainer/**'
      - 'scripts/setup'
      - 'pyproject.toml'
  pull_request:
    paths:
      - '.devcontainer/**'
      - 'scripts/setup'
      - 'pyproject.toml'
  workflow_dispatch:

jobs:
  build:
    name: "Build and Test Dev Container"
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Build and test dev container
        uses: devcontainers/ci@v0.3
        with:
          push: never
          runCmd: |
            echo "=== Dev Container Environment Validation ==="
            echo ""
            echo "ğŸ“ Working directory:"
            pwd
            echo ""
            echo "ğŸ Python version:"
            python --version
            echo ""
            echo "ğŸ“¦ uv version:"
            uv --version || echo "âš ï¸  uv not found"
            echo ""
            echo "ğŸ” ruff version:"
            ruff --version || echo "âš ï¸  ruff not found"
            echo ""
            echo "ğŸ§ª pytest version:"
            pytest --version || echo "âš ï¸  pytest not found"
            echo ""
            echo "ğŸ“‹ Installed packages:"
            uv pip list || pip list
            echo ""
            echo "âœ… Dev container built and configured successfully!"
